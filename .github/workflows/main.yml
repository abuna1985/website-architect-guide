name: Issue Automation
on:
  issue_comment:
    types: [created]
  pull_request:
    types: [opened]
jobs:
  add-to-column:
    if: ${{ github.event_name == 'issue_comment' && github.event.action == 'created' || github.event_name == 'pull_request' && github.event.action == 'opened' }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Set column name and labels
        id: set-values
        run: |
          echo "::set-output name=column-name::$(echo ${{ github.event_name == 'pull_request' ? 'ðŸ‘€ In Review' : 'ðŸ“‹ Backlog' }})"
          echo "::set-output name=labels::$(echo ${{ github.event_name == 'pull_request' ? 'needs-review' : 'needs-triage' }})"
          
      - name: Add new issue to project column
        uses: konradpabjan/actions-add-new-issue-to-column@v1.1
        with:
          repo-token: ${{ secrets.GH_API_TOKEN }}
          project_url: 'https://github.com/users/abuna1985/projects/7'
          column-name: ${{ steps.set-values.outputs.column-name }}
          labels: ${{ steps.set-values.outputs.labels }}
